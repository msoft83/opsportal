<!doctype html>
<html lang="en" dir="ltr">
<head>
  <script src="_shared/remote-bridge.js"></script>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Station Display — Auto-Scroll + Photo</title>
  
<style>
:root{--border:#e5e7eb;--body:#111827;--muted:#6b7280;--primary:#0d6efd;--light:#f8fafc;}
*{box-sizing:border-box}body{margin:0;background:#fff;color:#111827;font-family:system-ui,Segoe UI,Roboto,Arial}
.container{max-width:1120px;margin:0 auto;padding:1rem}
h1{font-size:1.5rem;margin:0 0 .75rem}
.small{font-size:.875rem;color:#6b7280}
.controls{display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:.75rem}
.controls.sticky{position:sticky;top:0;z-index:1000;background:#fff;padding:.5rem .5rem;border-bottom:1px solid var(--border)}
.form-control,.form-select{padding:.45rem .7rem;border:1px solid var(--border);border-radius:.375rem;background:#fff;min-height:36px}
.btn{display:inline-block;padding:.45rem .9rem;border-radius:.375rem;border:1px solid var(--border);background:#fff;cursor:pointer}
.btn-primary{background:#0d6efd;border-color:transparent;color:#fff}
.btn-danger{background:#ef4444;border-color:transparent;color:#fff}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:.6rem}
.card{background:#fff;border:1px solid var(--border);border-radius:.6rem;box-shadow:0 1px 3px rgba(0,0,0,.05);overflow:hidden}
.card-body{padding:.6rem .7rem}
.row{display:flex;align-items:center;gap:.6rem}
.thumb-sm{width:42px;height:42px;border-radius:6px;object-fit:cover;background:#f3f4f6;border:1px solid var(--border)}
.title{font-weight:600}
.meta{font-size:.8rem;color:#6b7280}
.inline{display:flex;align-items:center;gap:.4rem;margin-top:.4rem}
.badge{display:inline-block;padding:.2rem .45rem;border-radius:.35rem;background:#eef2ff;color:#3730a3;font-size:.75rem}
.section{margin:.75rem 0 1rem}
.list{border:1px solid var(--border);border-radius:.6rem;overflow:hidden}
.letter{font-size:1.15rem;font-weight:700;margin:.6rem 0 .25rem;border-bottom:1px solid var(--border);padding-bottom:.1rem;position:sticky;top:48px;background:#fff;z-index:10}
.item{display:flex;justify-content:space-between;align-items:center;padding:.55rem .75rem;border-top:1px solid var(--border)}
.item:first-child{border-top:none}
.left{display:flex;align-items:center;gap:.6rem}
.thumb-md{width:86px;height:86px;border-radius:10px;object-fit:cover;background:#f3f4f6;border:1px solid var(--border)}
.filebox{display:flex;align-items:center;gap:.5rem;border:1px dashed var(--border);padding:.4rem .6rem;border-radius:.5rem;background:#fff}

/* Bigger station code in Display */
.station-big{font-size:1.6rem;font-weight:800;line-height:1;color:#111827;background:#eef2ff;border:1px solid var(--border);border-radius:.55rem;padding:.2rem .5rem;min-width:84px;text-align:center}
@media (min-width: 768px){ .station-big{font-size:2rem; min-width:110px;} }
.item{gap:.75rem}
.item .left{flex:1}
.item .right{display:flex;align-items:center;justify-content:flex-end;min-width:90px}


/* Libershare pill for Display */
.pill-liber{display:inline-block;background:#fff7ed;border:1px solid #fdba74;color:#9a3412;
  padding:.06rem .35rem;border-radius:.4rem;font-size:.9rem;line-height:1.2;font-weight:700;margin-left:.4rem}
        </style>



<style>
/* ES_V53_IDCARD_TWO_COL */
/* Keep EXACTLY two columns; visually separate columns as panels, and render each item as an ID card. */
#displayMount, .section .list{
  display: grid !important;
  grid-template-columns: repeat(2, minmax(0,1fr)) !important;
  gap: 16px !important;
  position: relative;
  padding: 10px;
  border-radius: 14px;
  /* two soft panels to separate columns */
  background: linear-gradient(to right,
              #f7faff 0%, #f7faff 50%,
              #ffffff 50%, #ffffff 100%);
  /* subtle frame */
  box-shadow: inset 0 0 0 1px #e6edf7;
}

/* ID card look for each item */
.section .list .item, #displayMount .item{
  position: relative;
  background: #ffffff;
  border: 1.5px solid #e4e9f2;
  border-radius: 16px;
  padding: .9rem 1rem;
  box-shadow: 0 10px 24px rgba(16, 24, 40, .06);
  transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
  overflow: hidden;
}

.section .list .item:hover, #displayMount .item:hover{
  transform: translateY(-2px);
  box-shadow: 0 16px 36px rgba(16, 24, 40, .10);
  border-color: #cfd8e8;
}

/* Accent band (ID-card header) */
.section .list .item::before, #displayMount .item::before{
  content:"";
  position:absolute; left:0; right:0; top:0; height:6px;
  background: linear-gradient(90deg, #93c5fd, #60a5fa 60%, #3b82f6);
}

/* Avatar tune */
.section .list .item .thumb-md, #displayMount .item .thumb-md{
  width: 92px; height: 92px;
  border-radius: 12px;
  object-fit: cover;
  background: #f3f5f9;
  border: 1px solid #e5e9f2;
  box-shadow: inset 0 1px 3px rgba(16, 24, 40, .07);
}

/* Name line */
.section .list .item .left strong, #displayMount .item .left strong{
  font-size: 1.06rem;
  letter-spacing: .1px;
}

/* Pills slight lift */
.login-pill, .pill-liber, .ls-badge{
  box-shadow: 0 1px 2px rgba(16, 24, 40, .06);
  border-width: 1.25px;
}

/* Station number as dark blue on very light blue (highlight) */
.section .list .item .right .station-big, #displayMount .item .right .station-big{
  display:inline-block;
  font-size: 1.15rem;
  min-width: 96px;
  text-align:center;
  padding: .35rem .65rem;
  border-radius: 12px;
  background: #f0f7ff !important;   /* very light blue */
  color: #0b2a6b !important;         /* dark blue */
  border: 1.5px solid #c7dcff !important;
  box-shadow: inset 0 1px 2px rgba(11,42,107,.08);
}

/* Column separation trick: increase inner spacing per column */
#displayMount > *:nth-child(2n+1), .section .list > *:nth-child(2n+1){
  margin-right: 8px;
}
#displayMount > *:nth-child(2n), .section .list > *:nth-child(2n){
  margin-left: 8px;
}

/* training tags */
.tags{display:flex;flex-wrap:wrap;gap:.35rem;margin-top:.45rem}
.tag{display:inline-flex;align-items:center;gap:.35rem;padding:.2rem .45rem;border-radius:.5rem;font-size:.78rem;border:1px solid rgba(0,0,0,.08)}
.tag{background:#eef2ff}

/* login-pill directly after image; same width as avatar */
.login-pill{
  display:inline-block;
  width:92px;          /* match .thumb-md in ID-card theme */
  text-align:center;
  padding:.18rem .35rem;
  border-radius:.45rem;
  font-size:.82rem;
  font-weight:800;
  background:#ecfdf5;  /* very light green */
  color:#14532d;       /* dark green text */
  border:1.5px solid #059669;
  line-height:1.1;
}

/* --- Minimal patch --- */
/* Hide the plain name span inside the left block, keep login-pill and pill-liber visible */
.item .left span:not(.login-pill):not(.pill-liber){display:none !important;}

/* Keep tags contained within the card even if there are many or very long labels */
.tags{max-width:100%;}
.tag{white-space:normal;overflow-wrap:anywhere;}
</style>


  <script src="_shared/remote-config.js"></script>
</head>

<!-- Remote refresh (dev only) --><script>window.addEventListener("keydown",e=>{if(e.altKey&&e.key==="R"){ES_REMOTE.refreshFromRemote();}});</script>
  <div class="container">
    <h1>Station Display <span class="small">— auto-scroll up/down & loop (controls stay visible)</span></h1>
    <div class="controls sticky">
      <input id="searchInput" class="form-control" placeholder="Search by name or Station">
      <button class="btn" id="clearBtn" type="button">Clear</button>
      <a class="btn" href="StationSetup.html" target="_blank">Open Setup</a>
      <button class="btn" id="btnClearStations" type="button">Clear Stations</button>
      <span class="small">|</span>
      <button class="btn btn-primary" id="btnPlay" type="button">Play</button>
      <button class="btn" id="btnPause" type="button">Pause</button>
      <label class="small">Direction:
        <select id="dirSel" class="form-select">
          <option value="up" selected>Up</option>
          <option value="down">Down</option>
        </select>
      </label>
      <label class="small">Speed:
        <select id="speedSel" class="form-select">
          <option value="1">Slow</option>
          <option value="2" selected>Medium</option>
          <option value="4">Fast</option>
          <option value="6">Ultra</option>
        </select>
      </label>
      <button class="btn" id="btnRestart" type="button">Restart</button>
    </div>
    <div class="small" id="countInfo"></div>
    <div id="sections"></div>

    <script id="embedded-data" type="application/json">[{"uid": "12061986", "employee_id": "200871664", "user_id": "anwmccul", "first_name": "Andrew", "employee_type": "3PTY", "barcode_id": "12061986", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=anwmccul"}, {"uid": "14044572", "employee_id": "204964561", "user_id": "isianmol", "first_name": "Anmoldeep", "employee_type": "TEMP", "barcode_id": "14044572", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=isianmol"}, {"uid": "13725320", "employee_id": "200651934", "user_id": "nhariski", "first_name": "Josh", "employee_type": "3PTY", "barcode_id": "13725320", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=nhariski"}, {"uid": "12599528", "employee_id": "201267789", "user_id": "deolusun", "first_name": "Sunny", "employee_type": "AMZN", "barcode_id": "12599528", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=deolusun"}, {"uid": "12847518", "employee_id": "200913379", "user_id": "ilithian", "first_name": "Li-Thian", "employee_type": "AMZN", "barcode_id": "12847518", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=ilithian"}, {"uid": "13318898", "employee_id": "205370693", "user_id": "hshahanq", "first_name": "Hitesh", "employee_type": "TEMP", "barcode_id": "13318898", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=hshahanq"}, {"uid": "15237954", "employee_id": "201905971", "user_id": "syednazx", "first_name": "Syed", "employee_type": "AMZN", "barcode_id": "15237954", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=syednazx"}, {"uid": "14934908", "employee_id": "202597078", "user_id": "espejoml", "first_name": "Liliana", "employee_type": "3PTY", "barcode_id": "14934908", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=espejoml"}, {"uid": "11733874", "employee_id": "200760782", "user_id": "ajaiiaks", "first_name": "AKSHAY", "employee_type": "AMZN", "barcode_id": "11733874", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=ajaiiaks"}, {"uid": "13975833", "employee_id": "203169108", "user_id": "siyohana", "first_name": "Simi", "employee_type": "AMZN", "barcode_id": "13975833", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=siyohana"}, {"uid": "12518585", "employee_id": "204047157", "user_id": "muhumade", "first_name": "Aden", "employee_type": "TEMP", "barcode_id": "12518585", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=muhumade"}, {"uid": "11807356", "employee_id": "202309256", "user_id": "edpancha", "first_name": "Dhruvesh", "employee_type": "AMZN", "barcode_id": "11807356", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=edpancha"}, {"uid": "12531093", "employee_id": "204271339", "user_id": "sulelabd", "first_name": "Suleiman", "employee_type": "TEMP", "barcode_id": "12531093", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=sulelabd"}, {"uid": "15091753", "employee_id": "200603981", "user_id": "galiarif", "first_name": "ARIF", "employee_type": "AMZN", "barcode_id": "15091753", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=galiarif"}, {"uid": "12208740", "employee_id": "110663833", "user_id": "vmarhire", "first_name": "Hiren", "employee_type": "3PTY", "barcode_id": "12208740", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=vmarhire"}, {"uid": "13357725", "employee_id": "205350339", "user_id": "bhaktthq", "first_name": "Bhakti", "employee_type": "TEMP", "barcode_id": "13357725", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=bhaktthq"}, {"uid": "13719880", "employee_id": "111107095", "user_id": "fazelmoh", "first_name": "Mohammad", "employee_type": "3PTY", "barcode_id": "13719880", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=fazelmoh"}, {"uid": "11409779", "employee_id": "200699684", "user_id": "caminpad", "first_name": "Amin", "employee_type": "AMZN", "barcode_id": "11409779", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=caminpad"}, {"uid": "0", "employee_id": "202309121", "user_id": "majiabdo", "first_name": "Majid", "employee_type": "AMZN", "barcode_id": "0", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=majiabdo"}, {"uid": "13340886", "employee_id": "201943431", "user_id": "csajagan", "first_name": "Ganga", "employee_type": "AMZN", "barcode_id": "13340886", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=csajagan"}, {"uid": "12713570", "employee_id": "202165803", "user_id": "yuktav", "first_name": "Yukta", "employee_type": "AMZN", "barcode_id": "12713570", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=yuktav"}, {"uid": "14182106", "employee_id": "200880273", "user_id": "chenyuav", "first_name": "Yuanfu", "employee_type": "AMZN", "barcode_id": "14182106", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=chenyuav"}, {"uid": "14963345", "employee_id": "205346214", "user_id": "igosmaya", "first_name": "Mayank", "employee_type": "TEMP", "barcode_id": "14963345", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=igosmaya"}, {"uid": "12029241", "employee_id": "202409220", "user_id": "iousmndi", "first_name": "Ousmane", "employee_type": "AMZN", "barcode_id": "12029241", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=iousmndi"}, {"uid": "14280746", "employee_id": "204543429", "user_id": "mayambbe", "first_name": "Bernisse", "employee_type": "3PTY", "barcode_id": "14280746", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=mayambbe"}, {"uid": "14423218", "employee_id": "110458662", "user_id": "lebaille", "first_name": "Lee", "employee_type": "3PTY", "barcode_id": "14423218", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=lebaille"}, {"uid": "11637131", "employee_id": "202046595", "user_id": "prabhjiy", "first_name": "Prabh", "employee_type": "AMZN", "barcode_id": "11637131", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=prabhjiy"}, {"uid": "12001867", "employee_id": "200646341", "user_id": "rhafaiza", "first_name": "Faiza", "employee_type": "AMZN", "barcode_id": "12001867", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=rhafaiza"}, {"uid": "14370543", "employee_id": "200754292", "user_id": "loanlle", "first_name": "Loan", "employee_type": "AMZN", "barcode_id": "14370543", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=loanlle"}, {"uid": "12322038", "employee_id": "201913515", "user_id": "kpatesak", "first_name": "Sakshi", "employee_type": "AMZN", "barcode_id": "12322038", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=kpatesak"}, {"uid": "13787030", "employee_id": "203920384", "user_id": "fcyriell", "first_name": "Cyrielle", "employee_type": "AMZN", "barcode_id": "13787030", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=fcyriell"}, {"uid": "11191786", "employee_id": "200880276", "user_id": "yitjin", "first_name": "Jing", "employee_type": "AMZN", "barcode_id": "11191786", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=yitjin"}, {"uid": "216780", "employee_id": "204738173", "user_id": "hamayoq", "first_name": "Mayo", "employee_type": "3PTY", "barcode_id": "216780", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=hamayoq"}, {"uid": "12779207", "employee_id": "202343364", "user_id": "kaurykhu", "first_name": "Khushdeep", "employee_type": "AMZN", "barcode_id": "12779207", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=kaurykhu"}, {"uid": "13613190", "employee_id": "203898314", "user_id": "mgeeleka", "first_name": "Geele", "employee_type": "AMZN", "barcode_id": "13613190", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=mgeeleka"}, {"uid": "13449410", "employee_id": "203227377", "user_id": "pandavva", "first_name": "Vandit", "employee_type": "TEMP", "barcode_id": "13449410", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=pandavva"}, {"uid": "15226098", "employee_id": "200714813", "user_id": "foampasc", "first_name": "PASCAL", "employee_type": "TEMP", "barcode_id": "15226098", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=foampasc"}, {"uid": "11365574", "employee_id": "200547453", "user_id": "cseleren", "first_name": "selam", "employee_type": "AMZN", "barcode_id": "11365574", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=cseleren"}, {"uid": "11160301", "employee_id": "201752232", "user_id": "fmohkhat", "first_name": "khatra", "employee_type": "AMZN", "barcode_id": "11160301", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=fmohkhat"}, {"uid": "11475651", "employee_id": "203260894", "user_id": "fthierra", "first_name": "Andrea", "employee_type": "3PTY", "barcode_id": "11475651", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=fthierra"}, {"uid": "15299050", "employee_id": "202234844", "user_id": "janbanya", "first_name": "Janos", "employee_type": "3PTY", "barcode_id": "15299050", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=janbanya"}, {"uid": "11621939", "employee_id": "203979863", "user_id": "mitkhush", "first_name": "Miss", "employee_type": "AMZN", "barcode_id": "11621939", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=mitkhush"}, {"uid": "12575261", "employee_id": "202729340", "user_id": "joflanca", "first_name": "Joshua", "employee_type": "3PTY", "barcode_id": "12575261", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=joflanca"}, {"uid": "14426402", "employee_id": "200875781", "user_id": "denibris", "first_name": "Denis", "employee_type": "AMZN", "barcode_id": "14426402", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=denibris"}, {"uid": "15123596", "employee_id": "201267722", "user_id": "etchouwa", "first_name": "Evelyne", "employee_type": "AMZN", "barcode_id": "15123596", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=etchouwa"}, {"uid": "12165170", "employee_id": "204271292", "user_id": "mohiqrow", "first_name": "IQRO", "employee_type": "TEMP", "barcode_id": "12165170", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=mohiqrow"}, {"uid": "13350298", "employee_id": "109366203", "user_id": "gracetet", "first_name": "Teta", "employee_type": "AMZN", "barcode_id": "13350298", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=gracetet"}, {"uid": "13466384", "employee_id": "204248224", "user_id": "varmeetk", "first_name": "Meet", "employee_type": "TEMP", "barcode_id": "13466384", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=varmeetk"}, {"uid": "13240071", "employee_id": "205076017", "user_id": "tolljake", "first_name": "Jakeob", "employee_type": "3PTY", "barcode_id": "13240071", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=tolljake"}, {"uid": "13619784", "employee_id": "201943389", "user_id": "brwshaka", "first_name": "Brandon", "employee_type": "AMZN", "barcode_id": "13619784", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=brwshaka"}, {"uid": "15127481", "employee_id": "203847189", "user_id": "lanitcha", "first_name": "Anitaben", "employee_type": "TEMP", "barcode_id": "15127481", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=lanitcha"}, {"uid": "13256605", "employee_id": "200536296", "user_id": "ammtheva", "first_name": "Ammany", "employee_type": "AMZN", "barcode_id": "13256605", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=ammtheva"}, {"uid": "12222571", "employee_id": "110895730", "user_id": "rhardiza", "first_name": "Hardik", "employee_type": "3PTY", "barcode_id": "12222571", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=rhardiza"}, {"uid": "13750145", "employee_id": "112736545", "user_id": "insimile", "first_name": "Coletta", "employee_type": "AMZN", "barcode_id": "13750145", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=insimile"}, {"uid": "13225249", "employee_id": "200928118", "user_id": "raminani", "first_name": "Ramina", "employee_type": "AMZN", "barcode_id": "13225249", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=raminani"}, {"uid": "14400621", "employee_id": "204407170", "user_id": "rinrinkm", "first_name": "Rinku", "employee_type": "TEMP", "barcode_id": "14400621", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=rinrinkm"}, {"uid": "13400843", "employee_id": "200699770", "user_id": "qosmanha", "first_name": "Hana", "employee_type": "AMZN", "barcode_id": "13400843", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=qosmanha"}, {"uid": "11167276", "employee_id": "113031502", "user_id": "olgpard", "first_name": "Olga", "employee_type": "AMZN", "barcode_id": "11167276", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=olgpard"}, {"uid": "13814605", "employee_id": "203377807", "user_id": "komakauf", "first_name": "Komaljeet", "employee_type": "AMZN", "barcode_id": "13814605", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=komakauf"}, {"uid": "14768465", "employee_id": "203227375", "user_id": "adenijki", "first_name": "kikelomo", "employee_type": "AMZN", "barcode_id": "14768465", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=adenijki"}, {"uid": "11615927", "employee_id": "202120383", "user_id": "arlenkus", "first_name": "Arlette", "employee_type": "AMZN", "barcode_id": "11615927", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=arlenkus"}, {"uid": "12827525", "employee_id": "106751597", "user_id": "labaahme", "first_name": "Modie", "employee_type": "AMZN", "barcode_id": "12827525", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=labaahme"}, {"uid": "11387412", "employee_id": "200351601", "user_id": "zherjane", "first_name": "Janet", "employee_type": "3PTY", "barcode_id": "11387412", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=zherjane"}, {"uid": "14909029", "employee_id": "200379341", "user_id": "kaukarmq", "first_name": "Karmveer", "employee_type": "AMZN", "barcode_id": "14909029", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=kaukarmq"}, {"uid": "11620625", "employee_id": "200994324", "user_id": "mowcmoha", "first_name": "Mohamed", "employee_type": "AMZN", "barcode_id": "11620625", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=mowcmoha"}, {"uid": "13268677", "employee_id": "203865072", "user_id": "mporpaul", "first_name": "MPORE", "employee_type": "AMZN", "barcode_id": "13268677", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=mporpaul"}, {"uid": "12253969", "employee_id": "202185338", "user_id": "behboofa", "first_name": "Fatemeh", "employee_type": "AMZN", "barcode_id": "12253969", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=behboofa"}, {"uid": "12178076", "employee_id": "203207701", "user_id": "bzacharw", "first_name": "Zacharie", "employee_type": "3PTY", "barcode_id": "12178076", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=bzacharw"}, {"uid": "14485512", "employee_id": "202942896", "user_id": "pitterja", "first_name": "Jacob", "employee_type": "3PTY", "barcode_id": "14485512", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=pitterja"}, {"uid": "11059138", "employee_id": "204248428", "user_id": "sfattahi", "first_name": "Sepehr", "employee_type": "TEMP", "barcode_id": "11059138", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=sfattahi"}, {"uid": "12992267", "employee_id": "200433057", "user_id": "rgraquel", "first_name": "Raquel", "employee_type": "AMZN", "barcode_id": "12992267", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=rgraquel"}, {"uid": "14310606", "employee_id": "200969439", "user_id": "malekalt", "first_name": "Tanjida", "employee_type": "AMZN", "barcode_id": "14310606", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=malekalt"}, {"uid": "187866", "employee_id": "104806754", "user_id": "amshukri", "first_name": "Shukri", "employee_type": "AMZN", "barcode_id": "187866", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=amshukri"}, {"uid": "13757003", "employee_id": "200964854", "user_id": "jasprmah", "first_name": "Jaspreet", "employee_type": "AMZN", "barcode_id": "13757003", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=jasprmah"}, {"uid": "13300951", "employee_id": "203141872", "user_id": "rapheawa", "first_name": "Rapheal", "employee_type": "AMZN", "barcode_id": "13300951", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=rapheawa"}, {"uid": "72507", "employee_id": "113059376", "user_id": "badgfrit", "first_name": "Badger", "employee_type": "AMZN", "barcode_id": "72507", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=badgfrit"}, {"uid": "14532128", "employee_id": "201363260", "user_id": "piseamus", "first_name": "Seamus", "employee_type": "3PTY", "barcode_id": "14532128", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=piseamus"}, {"uid": "14917641", "employee_id": "200880601", "user_id": "gaikcaka", "first_name": "Akash", "employee_type": "AMZN", "barcode_id": "14917641", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=gaikcaka"}, {"uid": "12665587", "employee_id": "203202705", "user_id": "chhdeepp", "first_name": "Deepak", "employee_type": "AMZN", "barcode_id": "12665587", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=chhdeepp"}, {"uid": "13476779", "employee_id": "110368418", "user_id": "colailau", "first_name": "Laura", "employee_type": "AMZN", "barcode_id": "13476779", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=colailau"}, {"uid": "13931969", "employee_id": "200413970", "user_id": "ljonatal", "first_name": "Jonathan", "employee_type": "AMZN", "barcode_id": "13931969", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=ljonatal"}, {"uid": "13816668", "employee_id": "202431581", "user_id": "iaminimo", "first_name": "Iman", "employee_type": "AMZN", "barcode_id": "13816668", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=iaminimo"}, {"uid": "299120", "employee_id": "200760689", "user_id": "dseykane", "first_name": "Seydi", "employee_type": "TEMP", "barcode_id": "299120", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=dseykane"}, {"uid": "12447106", "employee_id": "204250095", "user_id": "yasppate", "first_name": "Yashkumar", "employee_type": "TEMP", "barcode_id": "12447106", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=yasppate"}, {"uid": "13002426", "employee_id": "203579984", "user_id": "shsharig", "first_name": "shahriar", "employee_type": "AMZN", "barcode_id": "13002426", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=shsharig"}, {"uid": "11432321", "employee_id": "204989917", "user_id": "chsumiti", "first_name": "Sumit", "employee_type": "TEMP", "barcode_id": "11432321", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=chsumiti"}, {"uid": "11452944", "employee_id": "203202689", "user_id": "sambaffo", "first_name": "Samuel", "employee_type": "AMZN", "barcode_id": "11452944", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=sambaffo"}, {"uid": "11650855", "employee_id": "203230130", "user_id": "vadsacfi", "first_name": "Firoz", "employee_type": "AMZN", "barcode_id": "11650855", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=vadsacfi"}, {"uid": "12120271", "employee_id": "200754297", "user_id": "qccartil", "first_name": "Charles", "employee_type": "AMZN", "barcode_id": "12120271", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=qccartil"}, {"uid": "11734397", "employee_id": "113031391", "user_id": "harpsina", "first_name": "Harpreet", "employee_type": "AMZN", "barcode_id": "11734397", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=harpsina"}, {"uid": "11012489", "employee_id": "205403325", "user_id": "sunipsun", "first_name": "SUNIL", "employee_type": "TEMP", "barcode_id": "11012489", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=sunipsun"}, {"uid": "12704620", "employee_id": "202343449", "user_id": "dinawcj", "first_name": "CJ", "employee_type": "AMZN", "barcode_id": "12704620", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=dinawcj"}, {"uid": "12206628", "employee_id": "200491897", "user_id": "kahinhfa", "first_name": "Faisal", "employee_type": "AMZN", "barcode_id": "12206628", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=kahinhfa"}, {"uid": "13511268", "employee_id": "204950486", "user_id": "zjaypate", "first_name": "Jaykumar", "employee_type": "TEMP", "barcode_id": "13511268", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=zjaypate"}, {"uid": "14089286", "employee_id": "204538101", "user_id": "lprchawl", "first_name": "Pranav", "employee_type": "TEMP", "barcode_id": "14089286", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=lprchawl"}, {"uid": "12824540", "employee_id": "201191431", "user_id": "rtarakor", "first_name": "Taras", "employee_type": "3PTY", "barcode_id": "12824540", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=rtarakor"}, {"uid": "15204453", "employee_id": "204963277", "user_id": "patelsil", "first_name": "Silva", "employee_type": "TEMP", "barcode_id": "15204453", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=patelsil"}, {"uid": "15202238", "employee_id": "201815375", "user_id": "mohampay", "first_name": "Mohamed", "employee_type": "3PTY", "barcode_id": "15202238", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=mohampay"}, {"uid": "13482792", "employee_id": "105488996", "user_id": "hussnabd", "first_name": "abdi", "employee_type": "AMZN", "barcode_id": "13482792", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=hussnabd"}, {"uid": "12361694", "employee_id": "105050327", "user_id": "joycstev", "first_name": "joyce", "employee_type": "AMZN", "barcode_id": "12361694", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=joycstev"}, {"uid": "14399477", "employee_id": "204339585", "user_id": "priirako", "first_name": "Princia", "employee_type": "TEMP", "barcode_id": "14399477", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=priirako"}, {"uid": "12106056", "employee_id": "105050285", "user_id": "kademosu", "first_name": "Kayode", "employee_type": "3PTY", "barcode_id": "12106056", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=kademosu"}, {"uid": "14734350", "employee_id": "200928178", "user_id": "karsaidc", "first_name": "said", "employee_type": "AMZN", "barcode_id": "14734350", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=karsaidc"}, {"uid": "12428590", "employee_id": "204485451", "user_id": "nsabimau", "first_name": "Nsabimana", "employee_type": "TEMP", "barcode_id": "12428590", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=nsabimau"}, {"uid": "15050052", "employee_id": "200802981", "user_id": "gamvima", "first_name": "Vimal", "employee_type": "AMZN", "barcode_id": "15050052", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=gamvima"}, {"uid": "14458061", "employee_id": "200880363", "user_id": "rhawadir", "first_name": "HAWA", "employee_type": "AMZN", "barcode_id": "14458061", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=rhawadir"}, {"uid": "14998790", "employee_id": "203306158", "user_id": "jashnkau", "first_name": "Jashandeep", "employee_type": "AMZN", "barcode_id": "14998790", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=jashnkau"}, {"uid": "12624186", "employee_id": "202408949", "user_id": "mohhafha", "first_name": "Afham", "employee_type": "AMZN", "barcode_id": "12624186", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=mohhafha"}, {"uid": "12938845", "employee_id": "200433044", "user_id": "marinamj", "first_name": "Marina", "employee_type": "AMZN", "barcode_id": "12938845", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=marinamj"}, {"uid": "15171982", "employee_id": "112253688", "user_id": "fasholaa", "first_name": "Ayodele", "employee_type": "3PTY", "barcode_id": "15171982", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=fasholaa"}, {"uid": "11665977", "employee_id": "111097472", "user_id": "paavinam", "first_name": "Avinash", "employee_type": "3PTY", "barcode_id": "11665977", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=paavinam"}, {"uid": "12294800", "employee_id": "200913367", "user_id": "farahnav", "first_name": "Navid", "employee_type": "3PTY", "barcode_id": "12294800", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=farahnav"}, {"uid": "14822215", "employee_id": "200913373", "user_id": "htabdiri", "first_name": "Abdirizak", "employee_type": "AMZN", "barcode_id": "14822215", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=htabdiri"}, {"uid": "13629216", "employee_id": "200823011", "user_id": "zkamalho", "first_name": "Karan", "employee_type": "AMZN", "barcode_id": "13629216", "photo_url": "https://internal-cdn.amazon.com/badgephotos.amazon.com/?uid=zkamalho"}]</script>
    
<script>
const STORE_KEY='ES_DATASET_V4';
const STORE_STATIONS='ES_STATIONS_V4';
var ES_CH=null; try{ ES_CH = new BroadcastChannel('es-sync-v4'); }catch(e){ ES_CH = null; }
function readJSON(key, fallback){ try{ var t=localStorage.getItem(key); return t?JSON.parse(t):fallback; }catch(e){ return fallback; } }
function writeJSON(key, val){ localStorage.setItem(key, JSON.stringify(val)); if(ES_CH){ try{ ES_CH.postMessage({type:key, value:val}); }catch(e){} } }
function getDataset(fallback){ var ds=readJSON(STORE_KEY,null); if(!ds && fallback){ ds=fallback; writeJSON(STORE_KEY, ds); } return ds||[]; }
function setDataset(arr){ writeJSON(STORE_KEY, arr||[]); }
function clearDataset(){ writeJSON(STORE_KEY, []); }
function getStations(){ return readJSON(STORE_STATIONS, {})||{}; }
function setStations(map){ writeJSON(STORE_STATIONS, map||{}); }
function setStation(uid, station){ var map=getStations(); if(station){ map[uid]=station; } else { delete map[uid]; } setStations(map); }
function clearStations(){ setStations({}); }
window.addEventListener('storage', function(e){ if(e.key===STORE_KEY||e.key===STORE_STATIONS){ if(typeof window.onStoreUpdate==='function'){ try{ window.onStoreUpdate(e.key, JSON.parse(e.newValue||'null')); }catch(err){ location.reload(); } } else { location.reload(); } } });
if(ES_CH){ ES_CH.onmessage=function(ev){ if(ev.data && (ev.data.type===STORE_KEY || ev.data.type===STORE_STATIONS)){ if(typeof window.onStoreUpdate==='function'){ window.onStoreUpdate(ev.data.type, ev.data.value); } } }; }
</script>

    <script>
      function esc(s){ s = String(s); return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;'); }
      function ph(seed){ return "https://picsum.photos/seed/"+encodeURIComponent(seed)+"/220/220"; }
      function imgFromItem(item){ var seed = item.barcode_id || item.employee_id || item.user_id || item.first_name || 'x'; if(item.photo_url && /^https?:\/\//.test(item.photo_url)) return item.photo_url; return ph(seed); }
      function currentData(){ return getDataset(JSON.parse(document.getElementById('embedded-data').textContent)); }

      function groupAndSort(data){
        var m = getStations();
        var arr = []; for(var i=0;i<data.length;i++){ var x=data[i]; if(m[x.uid]) arr.push(x); }
        arr.sort(function(a,b){ var x=String(a.first_name||'').toLowerCase(), y=String(b.first_name||'').toLowerCase(); if(x<y) return -1; if(x>y) return 1; return 0; });
        var groups = {}; var i, n, ch, key;
        for(i=0;i<arr.length;i++){
          n = String(arr[i].first_name||'').trim(); ch = n? n[0].toUpperCase() : '#'; key = /[A-Z]/.test(ch) ? ch : '#';
          if(!groups[key]) groups[key]=[];
          groups[key].push(arr[i]);
        }
        var letters='ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
        var keys=[]; for(i=0;i<letters.length;i++){ if(groups[letters[i]]) keys.push(letters[i]); }
        if(groups['#']) keys.push('#');
        return {keys:keys, groups:groups};
      }

      
      // == training tags helpers ==
      function colorFor(txt){
        txt = String(txt||'').toLowerCase();
        var h=0; for(var i=0;i<txt.length;i++){ h = (h*31 + txt.charCodeAt(i)) % 360; }
        var bg = 'hsl(' + h + ' 80% 92%)', bd = 'hsl(' + h + ' 70% 60%)', fg = 'hsl(' + h + ' 40% 25%)';
        return {bg:bg, bd:bd, fg:fg};
      }
      function tagHTML(name){
        var c = colorFor(name);
        return '<span class="tag" style="background:'+c.bg+';border-color:'+c.bd+';color:'+c.fg+'">'+esc(name)+'</span>';
      }
      function trainingsHTML(item){
        var a = Array.isArray(item.training_list)? item.training_list : [];
        if(!a.length) return '';
        return a.map(tagHTML).join('');
      }
function renderAll(){
        var r = groupAndSort(currentData());
        var keys = r.keys, groups=r.groups;
        var container = document.getElementById('sections');
        var html=''; var total=0;
        for(var ki=0; ki<keys.length; ki++){
          var k = keys[ki];
          var list = groups[k];
          total += list.length;
          html += '<div class="section"><div class="letter">'+k+'</div><div class="list">';
          for(var j=0;j<list.length;j++){
            var x = list[j];
            var img = imgFromItem(x);
            html += '<div class="item">' +              '<div class="left"><img class="thumb-md" src="'+img+'" alt=""><span class="login-pill">'+esc(x.user_id||'')+'</span><span>'+esc(x.first_name||'—')+'</span></div>' +              '<div class="right"><div class="station-big">'+esc(getStations()[x.uid])+'</div></div>' +              '<div class="tags">'+trainingsHTML(x)+'</div>' +              '</div>';
          }
          html += '</div></div>';
        }
        container.innerHTML = html || '<div class="small">No assigned Stations yet.</div>';
        document.getElementById('countInfo').textContent = 'Total assigned: '+total;
      }

      // Auto-scroll
      var auto = { timer:null, step:2, dir:'up', interval:20 };
      function atBottom(){ return window.scrollY + window.innerHeight >= document.documentElement.scrollHeight - 2; }
      function atTop(){ return window.scrollY <= 0; }
      function startAuto(){ stopAuto(); auto.step = parseInt(document.getElementById('speedSel').value||'2',10); auto.dir = document.getElementById('dirSel').value||'up'; auto.timer = setInterval(function(){ if(auto.dir==='down'){ if(atBottom()) window.scrollTo(0,0); else window.scrollBy(0, auto.step); } else { if(atTop()) window.scrollTo(0, document.documentElement.scrollHeight); else window.scrollBy(0, -auto.step); } }, auto.interval); }
      function stopAuto(){ if(auto.timer){ clearInterval(auto.timer); auto.timer=null; } }
      function restartScroll(){ if(document.getElementById('dirSel').value==='down') window.scrollTo(0,0); else window.scrollTo(0, document.documentElement.scrollHeight); }

      // Search
      document.getElementById('searchInput').addEventListener('input', function(e){
        var q = e.target.value.trim().toLowerCase();
        var m = getStations();
        var all = currentData();
        var filtered = []; for(var i=0;i<all.length;i++){ var x=all[i]; if(m[x.uid] && (String(x.first_name||'').toLowerCase().indexOf(q)!==-1 || String(m[x.uid]||'').toLowerCase().indexOf(q)!==-1)) filtered.push(all[i]); }
        filtered.sort(function(a,b){ var x=String(a.first_name||'').toLowerCase(), y=String(b.first_name||'').toLowerCase(); if(x<y) return -1; if(x>y) return 1; return 0; });
        var groups={}; var i, n, ch, key; for(i=0;i<filtered.length;i++){ n=String(filtered[i].first_name||'').trim(); ch=n? n[0].toUpperCase():'#'; key=/[A-Z]/.test(ch)?ch:'#'; if(!groups[key]) groups[key]=[]; groups[key].push(filtered[i]); }
        var letters='ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split(''); var keys=[]; for(i=0;i<letters.length;i++){ if(groups[letters[i]]) keys.push(letters[i]); } if(groups['#']) keys.push('#');
        var html=''; var total=0; for(i=0;i<keys.length;i++){ var k=keys[i]; total+=groups[k].length; html += '<div class="section"><div class="letter">'+k+'</div><div class="list">'; var arr=groups[k]; for(var j=0;j<arr.length;j++){ var x=arr[j]; var img=imgFromItem(x); html += '<div class="item">' +              '<div class="left"><img class="thumb-md" src="'+img+'" alt=""><span class="login-pill">'+esc(x.user_id||'')+'</span><span>'+esc(x.first_name||'—')+'</span></div>' +              '<div class="right"><div class="station-big">'+esc(m[x.uid])+'</div></div>' +              '<div class="tags">'+trainingsHTML(x)+'</div>' +              '</div>'; } html += '</div></div>'; }
        document.getElementById('sections').innerHTML = html || '<div class="small">No matches.</div>';
        document.getElementById('countInfo').textContent = 'Total assigned: '+total;
        restartScroll();
      });
      document.getElementById('clearBtn').addEventListener('click', function(){ document.getElementById('searchInput').value=''; renderAll(); restartScroll(); });

      // Controls
      document.getElementById('btnPlay').addEventListener('click', function(){ startAuto(); });
      document.getElementById('btnPause').addEventListener('click', function(){ stopAuto(); });
      document.getElementById('speedSel').addEventListener('change', function(){ if(auto.timer) startAuto(); });
      document.getElementById('dirSel').addEventListener('change', function(){ if(auto.timer) startAuto(); });
      document.getElementById('btnRestart').addEventListener('click', restartScroll);
      document.getElementById('btnClearStations').addEventListener('click', function(){ clearStations(); renderAll(); restartScroll(); });

      window.onStoreUpdate = function(key, val){ if(key==='ES_DATASET_V4' || key==='ES_STATIONS_V4'){ var pos = window.scrollY / Math.max(1, document.documentElement.scrollHeight - window.innerHeight); renderAll(); window.scrollTo(0, pos * (document.documentElement.scrollHeight - window.innerHeight)); } };

      // Init
      renderAll();
      startAuto();
    </script>
  </div>

<script>
(function(){
  const DATA_KEY='ES_DATASET_V4';
  var ESCH=null; try{ ESCH=new BroadcastChannel('es-sync-v4'); }catch(e){}
  function getDataset(){ try{ return JSON.parse(localStorage.getItem(DATA_KEY)||'[]'); }catch(e){ return []; } }
  function buildNameLibMap(){
    var map={}; var ds=getDataset();
    for(var i=0;i<ds.length;i++){
      var r=ds[i]||{}; var nm=(r.first_name||'').trim().toLowerCase();
      if(!nm) continue;
      var lib = (r.libershare||'').trim();
      if(lib){ map[nm]=lib; }
    }
    return map;
  }
  function appendPills(){
    var map = buildNameLibMap();
    var nodes = document.querySelectorAll('.item .left, .list .left');
    nodes.forEach(function(left){
      try{
        if(left.querySelector('.pill-liber')) return;
        var t = (left.textContent||'').trim();
        if(!t) return;
        var first = t.split(/\s+/)[0].toLowerCase();
        var lib = map[first];
        if(!lib) return;
        var span = document.createElement('span');
        span.className='pill-liber';
        span.textContent = lib;
        left.appendChild(span);
      }catch(e){}
    });
  }
  document.addEventListener('DOMContentLoaded', function(){ setTimeout(appendPills, 50); });
  ['renderAll','render','draw','refresh'].forEach(function(name){
    try{
      if(typeof window[name]==='function' && !window[name]._libDecor){
        var orig = window[name];
        window[name] = function(){ var r = orig.apply(this, arguments); try{ appendPills(); }catch(e){} return r; };
        window[name]._libDecor = true;
      }
    }catch(e){}
  });
  try{ if(ESCH){ ESCH.onmessage=function(){ try{ appendPills(); }catch(e){} }; } }catch(e){}
  setInterval(function(){ try{ appendPills(); }catch(e){} }, 1500);
})();
</script>


<!-- ES remote re-render hook -->
<script>
(function(){
  function wants(k){
    try { return k===ES_REMOTE.KEYS.DATASET || k===ES_REMOTE.KEYS.STATIONS || k===ES_REMOTE.KEYS.HOLDER; } catch(e){ return false; }
  }
  function callRender(){
    try {
      if (typeof window.render === "function") return window.render();
      if (typeof window.renderTable === "function") return window.renderTable();
      if (typeof window.renderTrainingTable === "function") return window.renderTrainingTable();
      if (typeof window.refreshTable === "function") return window.refreshTable();
      if (typeof window.updateUI === "function") return window.updateUI();
    } catch(e){}
  }
  const prev = window.onStoreUpdate;
  window.onStoreUpdate = function(k,v){
    if (typeof prev === "function") { try{ prev(k,v); }catch(e){} }
    if (wants(k)) { callRender(); }
  };
  // First load: force remote pull so all tabs start from same snapshot
  document.addEventListener("DOMContentLoaded", function(){
    try { ES_REMOTE.refreshFromRemote(); } catch(e){}
    // Sometimes pages seed local immediately; wipe their seed in favor of remote when it arrives
    setTimeout(function(){ try { ES_REMOTE.refreshFromRemote(); } catch(e){} }, 1200);
  });
})();
</script>

</body>
</html>
