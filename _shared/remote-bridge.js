(function(){const G=window;const C=G.__ES_REMOTE_CFG__||{owner:"msoft83",repo:"opsportal",branch:"main",basePath:"data",forceHijack:true,verbose:true};function raw(f){return `https://raw.githubusercontent.com/${C.owner}/${C.repo}/${C.branch}/${C.basePath}/${f}?_=${Date.now()}`;}async function fj(f,fb){try{const r=await fetch(raw(f),{cache:"no-store"});if(!r.ok)throw 0;return await r.json();}catch(e){return fb??null;}}async function sha(f){const u=`https://api.github.com/repos/${C.owner}/${C.repo}/contents/${encodeURIComponent((C.basePath+'/'+f).replace(/^\/+/,''))}`;const r=await fetch(u,{headers:{"Accept":"application/vnd.github+json",...(C.token?{"Authorization":`Bearer ${C.token}`}:{})}});if(r.status===404)return null;if(!r.ok)throw 0;const j=await r.json();return j.sha||null;}async function commit(f,d,m){if(!C.token)throw 0;const u=`https://api.github.com/repos/${C.owner}/${C.repo}/contents/${encodeURIComponent((C.basePath+'/'+f).replace(/^\/+/,''))}`;const b=btoa(unescape(encodeURIComponent(JSON.stringify(d,null,2))));const s=await sha(f);const body={message:m||("Update "+f),content:b,branch:C.branch};if(s)body.sha=s;const r=await fetch(u,{method:"PUT",headers:{"Accept":"application/vnd.github+json","Content-Type":"application/json","Authorization":`Bearer ${C.token}`},body:JSON.stringify(body)});if(!r.ok)throw 0;return await r.json();}const R={config:C, getDataset:async()=>await fj("dataset.json",[]), getStations:async()=>await fj("stations.json",{}), getTraining:async()=>await fj("training.json",[]), setDataset:async(a)=>commit("dataset.json",Array.isArray(a)?a:[],"Update dataset.json"), setStations:async(o)=>commit("stations.json",o||{},"Update stations.json"), setTraining:async(a)=>commit("training.json",Array.isArray(a)?a:[],"Update training.json"), hijack:function(){G.currentDataset=async()=>{const d=await R.getDataset();return Array.isArray(d)?d:[];};G.setDataset=async(a)=>{if(!C.token)return;await R.setDataset(a);};G.readJSON=function(){return null;};G.writeJSON=async function(){return null;};}};G.ESRemote=R;if(C.forceHijack){if(document.readyState==="complete"||document.readyState==="interactive"){setTimeout(()=>R.hijack(),50);}else{document.addEventListener("DOMContentLoaded",()=>setTimeout(()=>R.hijack(),50));}}})();